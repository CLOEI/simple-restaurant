Written for Ambisius Coding Challenge
There's still some place that can be improved, but I think it's good enough for now.